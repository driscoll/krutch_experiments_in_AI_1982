1000 REM       KINGMOVE.BAS
1010 REM-------------------------------
1100 REM       MAIN PROGRAM
1110 GOSUB 1200: REM INITIALIZATION
1120 GOSUB 1400: REM INITIALIZE ARRAY
1130 GOSUB 1500: REM DRAW BOARD
1140 GOSUB 1900: REM PRINT CUR KG POSN
1150 GOSUB 1700: REM KING'S MOVE
1160 GOSUB 1900: REM PRINT CUR KG POSN
1170 GOTO 1150
1180 REM-------------------------------
1200 REM       INITIALIIZATION
1210 PRINT CHR$(147);
1220 Z = RND(-TI)
1230 CU = 1
1240 D1$ = CHR$(17)
1250 D5$ = D1$ + D1$ + D1$ + D1$ + D1$
1260 L1$ = CHR$(157)
1270 L3$ = L1$ + L1$ + L1$
1280 L8$ = L3$ + L3$ + L1$ + L1$
1290 R1$ = CHR$(29)
1300 R3$ = R1$ + R1$ + R1$
1310 R5$ = R3$ + R1$ + R1$
1320 U1$ = CHR$(145)
1330 KA$ = "+" + "+" + L1$ + U1$ + "+" + D1$ + "+" + L3$
1340 KB$ = D1$ + "+" + "+" + "+" + D1$
1350 K$ = KA$ + KB$
1360 EA$ = "   " + L3$ + D1$
1370 E$ = U1$ + EA$ + EA$ + EA$ + R3$
1380 RETURN
1390 REM-------------------------------
1400 REM       INITIALIZE ARRAY
1410 A$(1) = K$
1420 FOR K = 2 TO 9
1430 : A$(K) = E$
1440 NEXT K
1450 RETURN
1460 REM-------------------------------
1500 REM       DRAW BOARD
1510 V$ = "+" + "            "
1520 FOR K = 1 TO 24
1530 : PRINT V$ V$ V$ "+";
1540 NEXT K
1550 H$ = R1$ + "++++++++++++"
1560 PRINT CHR$(19);
1570 FOR K = 1 TO 3
1580 : PRINT H$ H$ H$ R1$ D5$
1590 NEXT K
1600 PRINT H$ H$ H$;
1610 RETURN
1620 REM-------------------------------
1700 REM       KING'S MOVE
1710 ST$ = "1"
1720 RA = INT(RND(1)) * 4 + 1): IF RA = 2 THEN 1720
1730 IF RA = 1 THEN IF CU = 3 OR CU = 6 THEN 1720
1740 IF RA = 4 THEN IF CU = 3 OR CU = 7 THEN 1720
1750 IF CU + RA > 9 THEN 1720
1760 PC = CU: CU = CU + RA
1770 ST$ = ST $ + MID$(STR$(CU)),2,1)
1780 GOSUB 1900: REM PRINT CUR KG POSN
1790 IF CU = 9 THEN PC = CU: CU = 1: GOTO 1810
1800 GOTO 1720
1810 IF LEN(ST$) <> 3 THEN 1830
1820 PRINT CHR$(19) "SHORTEST PATH: ";: PRINT ST$: GOTO 1820
1830 RETURN
1840 REM-------------------------------
1900 REM       PRINT CURRENT KING POSN
1910 PRINT L8$ U1$ E$ CHR$(19)
1920 A$(PC) = E$: A$(CU) = K$
1930 FOR K = 1 TO 9
1940 : PRINT R5$ A$(K) R5$;
1950 : IF K=3 OR K=6 THEN PRINT D1$;
1960 NEXT K
1970 RETURN
1980 REM-------------------------------